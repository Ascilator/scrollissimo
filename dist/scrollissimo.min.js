/**
 * Scrollissimo
 * Javascript plugin for smooth scroll-controlled animations
 * @version 0.3.5
 * @author frux <qdinov@yandex.ru>
 * @url https://github.com/Promo/scrollissimo
 */
!function(t,e){function i(){return Math.max(t.body.scrollHeight,t.documentElement.scrollHeight)}function n(t,e,i,n){var o,s,r=Math.min(i,n),a=Math.max(i,n),h=t,m=e;if(h>=r&&a>=h)o=h,s=Math.min(a,m);else if(a>=m&&m>=r)o=Math.max(r,h),s=Math.min(a,m);else{if(!(r>=h&&m>=a))return;o=r,s=a}return n>i?{from:o,to:s}:{from:s,to:o}}function o(t,e){return e=e||u||i(),"string"==typeof t?"%"===t.substr(-1,1)?parseFloat(t)/100:"px"===t.substr(-2,2)?parseFloat(t)/e:parseFloat(t)/e:isNaN(t)?void 0:t/e}function s(t,e,i){return isNaN(i)?p.push(new f(t,e,i)):l.push(new f(t,e,i)),this}function r(t,e){p.forEach(function(e){e.render(t)}),l.forEach(function(i){e?i._smoother.smooth(m,t):i.render(t)}),m=t}function a(t){var i=isNaN(t)?e.pageYOffset:t,n=i/(u-d);r(n,c.enableSmoothing),v=i}function h(t){F||(a(t),isNaN(t)&&setTimeout(a,10))}var m,u,d,c,f,p=[],l=[],F=!0,v=0;!function(){var t,i=["ms","moz","webkit","o"],n=i.length;if(e.requestAnimationFrame)e._rAF=e.requestAnimationFrame;else{for(t=0;n>t&&!e.requestAnimationFrame;t+=1)e._rAF=e[i[t]+"RequestAnimationFrame"]&&e[i[t]+"RequestAnimationFrame"];!e._rAF&&(e._rAF=function(t){return setTimeout(function(){t()},1e3/60)})}}(),c={add:s,knock:h,enableSmoothing:!0,_isTouchMode:"ontouchstart"in e,_test:{_getIntersection:n,_toPercents:o}},f=function(t,e,i){t&&(this.params={start:o(e||0),duration:o(t.duration()||0)},this.timeline=t.pause(),isNaN(i)||(this._maxSpeed=.001*i,this._smoother=new f.Smoother(this,this._maxSpeed)))},f.prototype.getIntersection=function(t,e){return n(this.params.start,this.params.start+this.params.duration,t,e)},f.prototype.render=function(t){var e=Math.round((t-this.params.start)/this.params.duration*1e3)/1e3,i=this.timeline.duration()*e;return this.timeline.seek(i),this},f.Smoother=function(t,e){this.status="idle",this.animateTo=0,this.maxSpeed=+e,this.queue=t},f.Smoother.prototype.smooth=function(t,i){var n=this.queue.getIntersection(t,i);return n?(this.animateTo=n.to,this.animateFrom=this.animateFrom||n.from,"idle"===this.status&&(this.status="busy",this.id=e._rAF(this.step.bind(this))),this):void 0},f.Smoother.prototype.step=function(){var t=this.animateTo-this.animateFrom;Math.abs(t)>this.maxSpeed?(this.queue.render(this.animateFrom+=this.maxSpeed*(t>0?1:-1)),e._rAF(this.step.bind(this))):(this.queue.render(this.animateTo),this.status="idle",this.animateFrom=this.animateTo)},e.addEventListener("load",function(){var t=[];u=i(),d=e.innerHeight,setTimeout(function(){var t=e.pageYOffset,i=t/(u-d);v=t,r(i,!1),F=!1},100),c._isTouchMode?c.enableSmoothing=!1:(stepwiseDetector=function(e){var i=!1;if(10===t.length&&window.removeEventListener("wheel",stepwiseDetector),t.push(e.deltaY),10===t.length){for(var n=1;10>n;n++)if(Math.abs(t[n]-t[n-1])>100){i=!0;break}c.enableSmoothing=i}},window.addEventListener("wheel",stepwiseDetector))}),"object"==typeof module?module.exports=c:e.Scrollissimo=c}(document,window);