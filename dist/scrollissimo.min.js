/**
 * Scrollissimo
 * Javascript plugin for smooth scroll-controlled animations
 * @version 0.4.0
 * @author frux <qdinov@yandex.ru>
 * @url https://github.com/Promo/scrollissimo
 */
!function(t,e){function i(){return Math.max(t.body.scrollHeight,t.documentElement.scrollHeight)}function n(t,e,i,n){var o,s,a=Math.min(i,n),r=Math.max(i,n),h=t,m=e;if(h>=a&&r>=h)o=h,s=Math.min(r,m);else if(r>=m&&m>=a)o=Math.max(a,h),s=Math.min(r,m);else{if(!(a>=h&&m>=r))return;o=a,s=r}return n>i?{from:o,to:s}:{from:s,to:o}}function o(t,e,i){return isNaN(i)?d.push(new u(t,e,i)):c.push(new u(t,e,i)),this}function s(t,e){d.forEach(function(e){e.render(t)}),c.forEach(function(i){e?i._smoother.smooth(p,t):i.render(t)})}function a(t){var i=isNaN(t)?e.pageYOffset:t;s(i,m.enableSmoothing),p=i}function r(t){f||(a(t),isNaN(t)&&setTimeout(a,10))}var h,m,u,d=[],c=[],f=!0,p=0;!function(){var t,i=["ms","moz","webkit","o"],n=i.length;if(e.requestAnimationFrame)e._rAF=e.requestAnimationFrame;else{for(t=0;n>t&&!e.requestAnimationFrame;t+=1)e._rAF=e[i[t]+"RequestAnimationFrame"]&&e[i[t]+"RequestAnimationFrame"];!e._rAF&&(e._rAF=function(t){return setTimeout(function(){t()},1e3/60)})}}(),m={add:o,knock:r,enableSmoothing:!0,_isTouchMode:"ontouchstart"in e,_test:{_getIntersection:n}},u=function(t,e,i){t&&(this.params={start:e||0,duration:t.duration()||0},this.timeline=t.pause(),isNaN(i)||(this._maxSpeed=i,this._smoother=new u.Smoother(this,this._maxSpeed)))},u.prototype.getIntersection=function(t,e){return n(this.params.start,this.params.start+this.params.duration,t,e)},u.prototype.render=function(t){var e=Math.round((t-this.params.start)/this.params.duration*1e3)/1e3,i=this.timeline.duration()*e;return this.timeline.seek(i),this},u.Smoother=function(t,e){this.status="idle",this.animateTo=0,this.maxSpeed=+e,this.queue=t},u.Smoother.prototype.smooth=function(t,i){var n=this.queue.getIntersection(t,i);return n?(this.animateTo=n.to,this.animateFrom=this.animateFrom||n.from,"idle"===this.status&&(this.status="busy",this.id=e._rAF(this.step.bind(this))),this):void 0},u.Smoother.prototype.step=function(){var t=this.animateTo-this.animateFrom;Math.abs(t)>this.maxSpeed?(this.queue.render(this.animateFrom+=this.maxSpeed*(t>0?1:-1)),e._rAF(this.step.bind(this))):(this.queue.render(this.animateTo),this.status="idle",this.animateFrom=this.animateTo)},e.addEventListener("load",function(){var t=[];h=i(),setTimeout(function(){var t=e.pageYOffset;p=t,s(t,!1),f=!1},100),m._isTouchMode?m.enableSmoothing=!1:(stepwiseDetector=function(e){var i=!1;if(10===t.length&&window.removeEventListener("wheel",stepwiseDetector),t.push(e.deltaY),10===t.length){for(var n=1;10>n;n++)if(Math.abs(t[n]-t[n-1])>100){i=!0;break}m.enableSmoothing=i}},window.addEventListener("wheel",stepwiseDetector))}),"object"==typeof module?module.exports=m:e.Scrollissimo=m}(document,window);